<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Scripts -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/muuri@0.9.5/dist/muuri.min.js"
      integrity="sha384-pjx/ohA+FGGT1DkH8NeTscW3x2H82LwvD4gfQIvtJ8JY5UjIdU82eel4/J5pCj8D"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"
      integrity="sha384-cMrTlShXEGSdSFA359p+3aVUxK/R+0TAfbRZMcTlAn8yqzxEDj05QsS65nTFMMj4"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"
      integrity="sha384-fXdIufVbE9aU7STmdk/DWK0imNOozId9fTwzM/gi0NfPjphEIC3gq0M760UnsKVy"
      crossorigin="anonymous"
    ></script>

    <!-- CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
      rel="stylesheet"
      integrity="sha384-JnI9fsy7u0hXe2CXur8V8MkHfeqi2q7x6KYi4DbEYIjZJuP2Z2eMlp2RbdO7p3zL"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=Pixelify+Sans&family=Raleway:wght@200&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./index.css" />

    <title>Faiz Kautsar - Portfolio</title>
  </head>
  <body>
    <nav class="container-fluid" id="navbar">
      <ul></ul>
      <ul>
        <li>
          <div id="ðŸ·ï¸">
            <p style="margin-bottom: 0; font-size: max(2em, 2.5vw)">
              Faiz Kautsar
            </p>
          </div>
          <div id="contacts">
            <a href="https://github.com/spuuntries"
              ><img
                src="https://asset.brandfetch.io/idZAyF9rlg/idd6TtF-kc.png"
                alt="github"
            /></a>
            <a href="https://www.linkedin.com/in/faiz-kautsar-6b6222249/"
              ><img
                src="https://asset.brandfetch.io/idJFz6sAsl/idO-lr4BCK.jpeg"
                alt="linkedin"
              />
            </a>
            <a href="https://discordapp.com/users/449941778750111764"
              ><img
                src="https://asset.brandfetch.io/idM8Hlme1a/idHdpdABAN.svg"
                alt="discord"
            /></a>
          </div>
        </li>
      </ul>
      <ul></ul>
    </nav>

    <div class="container">
      <div id="first-section">
        <div id="biodata" class="section">
          <div id="greet">
            <p id="head" class="greetelem">Hi There!</p>
            <p class="greetelem">I'm Faiz M. Kautsar,</p>
            <p class="greetelem">
              <b><span id="jobdesc"></span></b>
            </p>
          </div>
          <div id="ðŸ“·">
            <img src="./foto.webp" alt="My face, without glasses" />
          </div>
        </div>
        <br />
        <div id="works" class="section">
          <p id="workshead">My previous works:</p>
        </div>
      </div>
    </div>

    <script>
      fetch(window.location.origin + "/projects").then(async (res) => {
        array = (await res.json())["projects"];

        function getContrast(hexColor) {
          if (hexColor.indexOf("#") === 0) {
            hexColor = hexColor.slice(1);
          }
          if (hexColor.length === 3) {
            hexColor =
              hexColor[0] +
              hexColor[0] +
              hexColor[1] +
              hexColor[1] +
              hexColor[2] +
              hexColor[2];
          }
          if (hexColor.length !== 6) {
            throw new Error("Invalid HEX color.");
          }
          const r = parseInt(hexColor.slice(0, 2), 16),
            g = parseInt(hexColor.slice(2, 4), 16),
            b = parseInt(hexColor.slice(4, 6), 16);
          // https://stackoverflow.com/a/3943023/112731
          return r * 0.299 + g * 0.587 + b * 0.114 > 186
            ? "#000000"
            : "#FFFFFF";
        }

        function hexToRgb(hex) {
          let r = 0,
            g = 0,
            b = 0;

          // 3 digits
          if (hex.length == 4) {
            r = "0x" + hex[1] + hex[1];
            g = "0x" + hex[2] + hex[2];
            b = "0x" + hex[3] + hex[3];

            // 6 digits
          } else if (hex.length == 7) {
            r = "0x" + hex[1] + hex[2];
            g = "0x" + hex[3] + hex[4];
            b = "0x" + hex[5] + hex[6];
          }

          return "rgba(" + +r + "," + +g + "," + +b + "," + 1 + ")";
        }

        function createWork(title, desc, tech, img) {
          let newElement = document.createElement("div");
          newElement.classList.add("worksquare");

          function generateHex() {
            let bghex =
              "#" +
              (
                "000000" + Math.floor(Math.random() * 16777215).toString(16)
              ).slice(-6);
            try {
              getContrast(bghex);
            } catch (e) {
              return generateHex();
            }
            return bghex;
          }

          let bghex = generateHex();
          newElement.style.backgroundColor = hexToRgb(bghex);

          newElement.style.padding = "1em";

          let header = document.createElement("h2");
          let image = document.createElement("img");
          let techno = document.createElement("p");
          let caption = document.createElement("p");

          if (title.split(" ").length > 1) {
            title = title.split(" ").join("<br />");
          }

          let contrastCol = getContrast(bghex);
          header.innerHTML = title;
          techno.innerHTML = "<b>Tech: </b>" + tech;
          caption.textContent = desc;
          image.src = img;

          header.style.margin = 0;
          header.style.paddingRight = "1em";

          header.style.color = contrastCol;
          header.style.display = "inline-block";
          header.style.fontFamily = '"Pixelify Sans", cursive';
          techno.style.color = contrastCol;
          caption.style.color = contrastCol;

          caption.className = "wrapped";
          image.className = "workimg";

          newElement.appendChild(header);
          newElement.appendChild(image);
          newElement.appendChild(techno);
          newElement.appendChild(caption);

          newElement.style.position = "relative";
          newElement.style.zIndex = 0;

          // NOTE - This handles mouseover
          newElement.addEventListener("mouseover", () => {
            newElement.style.zIndex = 1;
            let match = newElement.style.backgroundColor.match(
                /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/
              ),
              rgba = {
                r: match[1],
                g: match[2],
                b: match[3],
                a: match[4] ? match[4] : 1,
              };

            anime({
              targets: rgba,
              a: 0.6,
              update: function () {
                newElement.style.backgroundColor = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;
              },
              duration: 100,
              easing: "linear",
            });

            anime({
              targets: newElement,
              scale: 2,
              easing: "easeOutElastic(1, 1)",
              duration: "250ms",
            });

            let bloor = { b: 0 };
            anime({
              targets: bloor,
              b: 10,
              update: function () {
                newElement.style.backdropFilter = `blur(${bloor.b}px)`;
              },
              duration: 100,
              easing: "linear",
            });

            caption.className = "";
          });

          // NOTE - This handles mouseleave
          newElement.addEventListener("mouseleave", () => {
            newElement.style.zIndex = 0;
            let match = newElement.style.backgroundColor.match(
                /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/
              ),
              rgba = {
                r: match[1],
                g: match[2],
                b: match[3],
                a: match[4] ? match[4] : 1,
              };

            anime({
              targets: rgba,
              a: 1,
              update: function () {
                newElement.style.backgroundColor = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;
              },
              duration: 100,
              easing: "linear",
            });

            let bloor = { b: 10 };
            anime({
              targets: bloor,
              b: 0,
              update: function () {
                newElement.style.backdropFilter = `blur(${bloor.b}px)`;
              },
              duration: 100,
              easing: "linear",
            });

            anime({
              targets: newElement,
              scale: 1,
              easing: "easeOutElastic(1, 1)",
              duration: "250ms",
            });

            caption.className = "wrapped";
          });

          return newElement;
        }

        const tag = document.getElementById("ðŸ·ï¸");
        tag.addEventListener("mouseenter", () => {
          anime({
            targets: tag,
            scale: 1.25,
          });
        });

        tag.addEventListener("mouseleave", () => {
          anime({ targets: tag, scale: 1, translateX: 1 });
        });

        document.addEventListener("DOMContentLoaded", () => {
          let trackDone = 0;

          function startTyping() {
            new Typed("#jobdesc", {
              strings: [
                "A Back-end<br>Developer",
                "A Front-end<br>Developer",
                "An AI Researcher",
                "A 2D Illustrator",
                "A Video Production<br>Technician",
              ],
              typeSpeed: 20,
              loop: true,
              onLastStringBackspaced: () => {
                if (!trackDone) {
                  anime({ targets: "#workshead", opacity: [0, 1] });
                  array.forEach((w) => {
                    document
                      .getElementById("works")
                      .appendChild(
                        createWork(
                          w.header,
                          w.caption,
                          w.tech.filter((s) => s.length).join(", ")
                        )
                      );
                  });
                  anime({
                    targets: ".worksquare",
                    opacity: [0, 1],
                    translateX: [-100, 1],
                    delay: anime.stagger(250),
                    easing: "easeOutElastic(1, 1)",
                  });
                }
                trackDone = 1;
              },
            });
          }

          anime({
            targets: "#ðŸ“·",
            opacity: [0, 1],
            translateX: [100, 1],
            easing: "easeOutElastic(1, .6)",
            complete: () => {
              anime({
                targets: ".greetelem",
                opacity: [0, 1],
                translateX: ["100%", "0"],
                easing: "easeOutElastic(1, 1)",
                delay: anime.stagger(100),
                complete: () => {
                  startTyping();
                },
              });
            },
          });
        });
      });
    </script>
  </body>
</html>
